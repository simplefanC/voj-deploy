(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-302219b4"],{1240:function(e,t,l){},b502:function(e,t,l){"use strict";l("1240")},fd98:function(e,t,l){"use strict";l.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"problem"},[t("el-card",[t("div",{attrs:{slot:"header"},slot:"header"},[t("span",{staticClass:"panel-title home-title"},[e._v(e._s(e.title))])]),t("el-form",{ref:"form",attrs:{model:e.problem,rules:e.rules,"label-position":"top","label-width":"70px"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$t("m.Problem_Display_ID"),prop:"problemId",required:""}},[t("el-input",{attrs:{disabled:e.problem.isRemote,placeholder:e.$t("m.Problem_Display_ID")},model:{value:e.problem.problemId,callback:function(t){e.$set(e.problem,"problemId",t)},expression:"problem.problemId"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$t("m.Title"),prop:"title",required:""}},[t("el-input",{attrs:{placeholder:e.$t("m.Title")},model:{value:e.problem.title,callback:function(t){e.$set(e.problem,"title",t)},expression:"problem.title"}})],1)],1)],1),e.contestID?t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{md:12,xs:24}},[t("el-form-item",{attrs:{label:e.$t("m.Contest_Display_Title"),required:""}},[t("el-input",{attrs:{placeholder:e.$t("m.Contest_Display_Title")},model:{value:e.contestProblem.displayTitle,callback:function(t){e.$set(e.contestProblem,"displayTitle",t)},expression:"contestProblem.displayTitle"}})],1)],1),t("el-col",{attrs:{md:12,xs:24}},[t("el-form-item",{attrs:{label:e.$t("m.Contest_Display_ID"),required:""}},[t("el-input",{attrs:{placeholder:e.$t("m.Contest_Display_ID")},model:{value:e.contestProblem.displayId,callback:function(t){e.$set(e.contestProblem,"displayId",t)},expression:"contestProblem.displayId"}})],1)],1)],1):e._e(),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$t("m.Description"),prop:"description",required:""}},[t("Editor",{attrs:{value:e.problem.description},on:{"update:value":function(t){return e.$set(e.problem,"description",t)}}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{md:6,xs:24}},[t("el-form-item",{attrs:{label:e.$t("m.Time_Limit")+"(ms)",required:""}},[t("el-input",{attrs:{disabled:e.problem.isRemote,placeholder:e.$t("m.Time_Limit"),type:"Number"},model:{value:e.problem.timeLimit,callback:function(t){e.$set(e.problem,"timeLimit",t)},expression:"problem.timeLimit"}})],1)],1),t("el-col",{attrs:{md:6,xs:24}},[t("el-form-item",{attrs:{label:e.$t("m.Memory_Limit")+"(mb)",required:""}},[t("el-input",{attrs:{disabled:e.problem.isRemote,placeholder:e.$t("m.Memory_Limit"),type:"Number"},model:{value:e.problem.memoryLimit,callback:function(t){e.$set(e.problem,"memoryLimit",t)},expression:"problem.memoryLimit"}})],1)],1),t("el-col",{attrs:{md:6,xs:24}},[t("el-form-item",{attrs:{label:e.$t("m.Stack_Limit")+"(mb)",required:""}},[t("el-input",{attrs:{disabled:e.problem.isRemote,placeholder:e.$t("m.Stack_Limit"),type:"Number"},model:{value:e.problem.stackLimit,callback:function(t){e.$set(e.problem,"stackLimit",t)},expression:"problem.stackLimit"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$t("m.Input"),prop:"input_description",required:""}},[t("Editor",{attrs:{value:e.problem.input},on:{"update:value":function(t){return e.$set(e.problem,"input",t)}}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$t("m.Output"),prop:"output_description",required:""}},[t("Editor",{attrs:{value:e.problem.output},on:{"update:value":function(t){return e.$set(e.problem,"output",t)}}})],1)],1),t("el-col",{attrs:{span:24}},[t("el-form-item",{staticStyle:{"margin-top":"20px"},attrs:{label:e.$t("m.Hint")}},[t("Editor",{attrs:{value:e.problem.hint},on:{"update:value":function(t){return e.$set(e.problem,"hint",t)}}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{md:3,xs:24}},[t("el-form-item",{attrs:{label:e.$t("m.Auth")}},[t("el-select",{attrs:{size:"small"},model:{value:e.problem.auth,callback:function(t){e.$set(e.problem,"auth",t)},expression:"problem.auth"}},[t("el-option",{attrs:{label:e.$t("m.Public_Problem"),value:1}}),t("el-option",{attrs:{label:e.$t("m.Private_Problem"),value:2}}),t("el-option",{attrs:{label:e.$t("m.Contest_Problem"),value:3}})],1)],1)],1),t("el-col",{attrs:{md:3,xs:24}},[t("el-form-item",{attrs:{label:e.$t("m.Level"),required:""}},[t("el-select",{attrs:{placeholder:"Enter the level of problem",size:"small"},model:{value:e.problem.difficulty,callback:function(t){e.$set(e.problem,"difficulty",t)},expression:"problem.difficulty"}},e._l(e.PROBLEM_LEVEL,(function(l,s,a){return t("el-option",{key:a,attrs:{label:e.getLevelName(s),value:parseInt(s)}})})),1)],1)],1),t("el-col",{attrs:{md:3,xs:24}},[t("el-form-item",{attrs:{label:e.$t("m.Code_Shareable")}},[t("el-switch",{attrs:{"active-text":"","inactive-text":""},model:{value:e.problem.codeShare,callback:function(t){e.$set(e.problem,"codeShare",t)},expression:"problem.codeShare"}})],1)],1),t("el-col",{attrs:{md:11,xs:24}},[t("el-form-item",{attrs:{label:e.$t("m.Tags"),required:""}},[e._l(e.problemTags,(function(l){return t("el-tag",{key:l.name,staticStyle:{"margin-right":"7px","margin-top":"4px"},attrs:{"close-transition":!1,closable:"",size:"small"},on:{close:function(t){return e.closeTag(l.name)}}},[e._v(e._s(l.name)+" ")])})),e.inputVisible?t("el-autocomplete",{staticClass:"input-new-tag",attrs:{"fetch-suggestions":e.querySearch,"trigger-on-focus":!0,size:"mini"},on:{click:e.selectTag,select:e.addTag},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addTag.apply(null,arguments)}},model:{value:e.tagInput,callback:function(t){e.tagInput=t},expression:"tagInput"}}):t("el-tooltip",{attrs:{content:e.$t("m.Add"),effect:"dark",placement:"top"}},[t("el-button",{staticClass:"button-new-tag",attrs:{icon:"el-icon-plus",size:"small"},on:{click:function(t){e.inputVisible=!0}}})],1)],2)],1)],1),t("el-row",[t("el-col",{attrs:{md:24,xs:24}},[t("el-form-item",{attrs:{error:e.error.languages,label:e.$t("m.Languages"),required:""}},[t("el-checkbox-group",{model:{value:e.problemLanguages,callback:function(t){e.problemLanguages=t},expression:"problemLanguages"}},e._l(e.allLanguage,(function(e){return t("el-tooltip",{key:e.name,staticClass:"spj-radio",attrs:{content:e.description,effect:"dark",placement:"top-start"}},[t("el-checkbox",{attrs:{label:e.name}})],1)})),1)],1)],1)],1),t("div",[t("div",{staticClass:"panel-title home-title"},[e._v(" "+e._s(e.$t("m.Problem_Examples"))+" "),t("el-popover",{attrs:{placement:"right",trigger:"hover"}},[t("p",[e._v(" "+e._s(e.$t("m.Problem_Examples_Desc"))+" ")]),t("i",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"})])],1),e._l(e.problem.examples,(function(l,s){return t("el-form-item",{key:"example"+s},[t("Accordion",{attrs:{index:s,isOpen:!!l.isOpen,title:e.$t("m.Problem_Example")+(s+1)},on:{changeVisible:e.changeExampleVisible}},[t("el-button",{attrs:{slot:"header",icon:"el-icon-delete",size:"small",type:"danger"},on:{click:function(t){return e.deleteExample(s)}},slot:"header"},[e._v(" "+e._s(e.$t("m.Delete"))+" ")]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{md:12,xs:24}},[t("el-form-item",{attrs:{label:e.$t("m.Example_Input"),required:""}},[t("el-input",{staticStyle:{"white-space":"pre-line"},attrs:{placeholder:e.$t("m.Example_Input"),rows:5,type:"textarea"},model:{value:l.input,callback:function(t){e.$set(l,"input",t)},expression:"example.input"}})],1)],1),t("el-col",{attrs:{md:12,xs:24}},[t("el-form-item",{attrs:{label:e.$t("m.Example_Output"),required:""}},[t("el-input",{attrs:{placeholder:e.$t("m.Example_Output"),rows:5,type:"textarea"},model:{value:l.output,callback:function(t){e.$set(l,"output",t)},expression:"example.output"}})],1)],1)],1)],1)],1)}))],2),t("div",{staticClass:"add-example-btn"},[t("el-button",{staticClass:"add-examples",attrs:{icon:"el-icon-plus",type:"small"},on:{click:function(t){return e.addExample()}}},[e._v(e._s(e.$t("m.Add_Example"))+" ")])],1),e.problem.isRemote?e._e():[t("div",{staticClass:"panel-title home-title"},[e._v(" "+e._s(e.$t("m.Judge_Extra_File"))+" "),t("el-popover",{attrs:{placement:"right",trigger:"hover"}},[t("p",[e._v(e._s(e.$t("m.Judge_Extra_File_Tips1")))]),t("p",[e._v(e._s(e.$t("m.Judge_Extra_File_Tips2")))]),t("i",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"})])],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{md:12,xs:24}},[t("el-form-item",[t("el-checkbox",{model:{value:e.addUserExtraFile,callback:function(t){e.addUserExtraFile=t},expression:"addUserExtraFile"}},[e._v(e._s(e.$t("m.User_Program"))+" ")])],1),e.addUserExtraFile?t("el-form-item",[t("AddExtraFile",{attrs:{files:e.userExtraFile,type:"user"},on:{"update:files":function(t){e.userExtraFile=t},deleteFile:e.deleteFile,upsertFile:e.upsertFile}})],1):e._e()],1),t("el-col",{attrs:{md:12,xs:24}},[t("el-form-item",[t("el-checkbox",{model:{value:e.addJudgeExtraFile,callback:function(t){e.addJudgeExtraFile=t},expression:"addJudgeExtraFile"}},[e._v(e._s(e.$t("m.SPJ_Or_Interactive_Program"))+" ")])],1),e.addJudgeExtraFile?t("el-form-item",[t("AddExtraFile",{attrs:{files:e.judgeExtraFile,type:"judge"},on:{"update:files":function(t){e.judgeExtraFile=t},deleteFile:e.deleteFile,upsertFile:e.upsertFile}})],1):e._e()],1)],1)],e.problem.isRemote?e._e():[t("div",{staticClass:"panel-title home-title"},[e._v(" "+e._s(e.$t("m.Judge_Mode"))+" "),t("el-popover",{attrs:{placement:"right",trigger:"hover"}},[t("p",[e._v("1. "+e._s(e.$t("m.General_Judge_Mode_Tips")))]),t("p",[e._v("2. "+e._s(e.$t("m.Special_Judge_Mode_Tips")))]),t("p",[e._v("3. "+e._s(e.$t("m.Interactive_Judge_Mode_Tips")))]),t("i",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"})])],1),t("el-form-item",{attrs:{error:e.error.spj,label:""}},[t("el-col",{attrs:{span:24}},[t("el-radio-group",{on:{change:e.switchMode},model:{value:e.problem.judgeMode,callback:function(t){e.$set(e.problem,"judgeMode",t)},expression:"problem.judgeMode"}},[t("el-radio",{attrs:{label:"default"}},[e._v(e._s(e.$t("m.General_Judge")))]),t("el-radio",{attrs:{label:"spj"}},[e._v(e._s(e.$t("m.Special_Judge")))]),t("el-radio",{attrs:{label:"interactive"}},[e._v(e._s(e.$t("m.Interactive_Judge"))+" ")])],1)],1)],1),"default"!=e.problem.judgeMode?t("el-form-item",[t("Accordion",{attrs:{title:"spj"==e.problem.judgeMode?e.$t("m.Special_Judge_Code"):e.$t("m.Interactive_Judge_Code")}},[t("template",{slot:"header"},[t("span",{staticStyle:{"margin-right":"5px"}},[e._v(e._s("spj"==e.problem.judgeMode?e.$t("m.SPJ_Language"):e.$t("m.Interactive_Language"))+"ï¼š")]),t("el-radio-group",{model:{value:e.problem.spjLanguage,callback:function(t){e.$set(e.problem,"spjLanguage",t)},expression:"problem.spjLanguage"}},e._l(e.allSpjLanguage,(function(l){return t("el-tooltip",{key:l.name,staticClass:"spj-radio",attrs:{content:l.description,effect:"dark",placement:"top-start"}},[t("el-radio",{attrs:{label:l.name}},[e._v(e._s(l.name))])],1)})),1),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{loading:e.loadingCompile,icon:"el-icon-folder-checked",size:"small",type:"primary"},on:{click:e.compileSPJ}},[e._v(e._s(e.$t("m.Compile"))+" ")])],1),t("code-mirror",{attrs:{mode:e.spjMode},model:{value:e.problem.spjCode,callback:function(t){e.$set(e.problem,"spjCode",t)},expression:"problem.spjCode"}})],2)],1):e._e()],t("div",{staticClass:"panel-title home-title"},[e._v(e._s(e.$t("m.Code_Template")))]),t("el-form-item",[t("el-row",e._l(e.codeTemplate,(function(l,s){return t("el-col",{key:"template"+s,attrs:{span:24}},[t("el-form-item",[t("el-checkbox",{model:{value:l.status,callback:function(t){e.$set(l,"status",t)},expression:"v.status"}},[e._v(e._s(s))]),l.status?t("div",[t("code-mirror",{attrs:{mode:l.mode},model:{value:l.code,callback:function(t){e.$set(l,"code",t)},expression:"v.code"}})],1):e._e()],1)],1)})),1)],1),e.problem.isRemote?e._e():t("el-row",{attrs:{gutter:20}},[t("div",{staticClass:"panel-title home-title"},[e._v(" "+e._s(e.$t("m.Judge_Samples"))+" "),t("el-popover",{attrs:{placement:"right",trigger:"hover"}},[t("p",[e._v(e._s(e.$t("m.Sample_Tips")))]),t("i",{staticClass:"el-icon-question",attrs:{slot:"reference"},slot:"reference"})])],1),t("el-form-item",{attrs:{required:""}},[t("el-switch",{staticStyle:{margin:"10px 0"},attrs:{"active-text":e.$t("m.Use_Upload_File"),"inactive-text":e.$t("m.Use_Manual_Input")},model:{value:e.problem.isUploadCase,callback:function(t){e.$set(e.problem,"isUploadCase",t)},expression:"problem.isUploadCase"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.problem.isUploadCase,expression:"problem.isUploadCase"}]},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{error:e.error.testcase}},[t("el-upload",{attrs:{action:e.uploadFileUrl,"on-error":e.uploadFailed,"on-success":e.uploadSucceeded,"show-file-list":!0,name:"file"}},[t("el-button",{attrs:{icon:"el-icon-upload",size:"small",type:"primary"}},[e._v(e._s(e.$t("m.Choose_File"))+" ")])],1)],1)],1),t("el-col",{attrs:{span:24}},[t("vxe-table",{attrs:{data:e.problem.testCaseScore,align:"center","auto-resize":"",stripe:""}},[t("vxe-table-column",{attrs:{title:e.$t("m.Sample_Input_File"),field:"input","min-width":"100"}}),t("vxe-table-column",{attrs:{title:e.$t("m.Sample_Output_File"),field:"output","min-width":"100"}}),t("vxe-table-column",{attrs:{title:e.$t("m.Score"),field:"score","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function({row:l}){return[t("el-input",{attrs:{disabled:1!=e.problem.type,placeholder:e.$t("m.Score"),size:"small"},model:{value:l.score,callback:function(t){e.$set(l,"score",t)},expression:"row.score"}})]}}],null,!1,1184783658)})],1)],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.problem.isUploadCase,expression:"!problem.isUploadCase"}]},[e._l(e.problemSamples,(function(l,s){return t("el-form-item",{key:"sample"+s},[t("Accordion",{attrs:{index:s,isOpen:!!l.isOpen,title:e.$t("m.Problem_Sample")+(s+1)},on:{changeVisible:e.changeSampleVisible}},[t("el-button",{attrs:{slot:"header",icon:"el-icon-delete",size:"small",type:"danger"},on:{click:function(t){return e.deleteSample(s)}},slot:"header"},[e._v(" "+e._s(e.$t("m.Delete"))+" ")]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{md:12,xs:24}},[t("el-form-item",{attrs:{label:e.$t("m.Sample_Input"),required:""}},[t("el-input",{attrs:{placeholder:e.$t("m.Sample_Input"),rows:5,type:"textarea"},model:{value:l.input,callback:function(t){e.$set(l,"input",t)},expression:"sample.input"}})],1)],1),t("el-col",{attrs:{md:12,xs:24}},[t("el-form-item",{attrs:{label:e.$t("m.Sample_Output"),required:""}},[t("el-input",{attrs:{placeholder:e.$t("m.Sample_Output"),rows:5,type:"textarea"},model:{value:l.output,callback:function(t){e.$set(l,"output",t)},expression:"sample.output"}})],1)],1),t("el-col",{directives:[{name:"show",rawName:"v-show",value:1==e.problem.type,expression:"problem.type == 1"}],attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$t("m.Score")}},[t("el-input",{attrs:{placeholder:e.$t("m.Score"),size:"small",type:"number"},model:{value:l.score,callback:function(t){e.$set(l,"score",t)},expression:"sample.score"}})],1)],1)],1)],1)],1)})),t("div",{staticClass:"add-sample-btn"},[t("el-button",{staticClass:"add-samples",attrs:{icon:"el-icon-plus",type:"small"},on:{click:function(t){return e.addSample()}}},[e._v(e._s(e.$t("m.Add_Sample"))+" ")])],1)],2)],1),t("el-form-item",{attrs:{label:e.$t("m.Source")}},[t("el-input",{attrs:{placeholder:e.$t("m.Source")},model:{value:e.problem.source,callback:function(t){e.$set(e.problem,"source",t)},expression:"problem.source"}})],1),e.problem.isRemote?e._e():t("el-form-item",{attrs:{label:e.$t("m.Auto_Remove_the_Blank_at_the_End_of_Code")}},[t("el-switch",{attrs:{"active-text":"","inactive-text":""},model:{value:e.problem.isRemoveEndBlank,callback:function(t){e.$set(e.problem,"isRemoveEndBlank",t)},expression:"problem.isRemoveEndBlank"}})],1),e.problem.isRemote?e._e():t("el-form-item",{attrs:{label:e.$t("m.Publish_the_Judging_Result_of_Test_Data")}},[t("el-switch",{attrs:{"active-text":"","inactive-text":""},model:{value:e.problem.openCaseResult,callback:function(t){e.$set(e.problem,"openCaseResult",t)},expression:"problem.openCaseResult"}})],1),t("el-button",{attrs:{size:"small",type:"primary"},nativeOn:{click:function(t){return e.submit()}}},[e._v(e._s(e.$t("m.Save"))+" ")])],2)],1)],1)},a=[],i=(l("24b8"),l("90b9")),r=l("7736"),o=l("3228"),m=l("7aa9"),p=l("9a36");const n=()=>l.e("chunk-1b666b40").then(l.bind(null,"a956")),d=()=>l.e("chunk-4b171caa").then(l.bind(null,"a2e7")),u=()=>Promise.all([l.e("chunk-013bf5e0"),l.e("chunk-68454783")]).then(l.bind(null,"da4f")),c=()=>Promise.all([l.e("chunk-013bf5e0"),l.e("chunk-fad2e1b8")]).then(l.bind(null,"ac13"));var h={name:"Problem",components:{Accordion:d,AddExtraFile:u,CodeMirror:c,Editor:n},data(){return{rules:{title:{required:!0,message:"Title is required",trigger:"blur"},input_description:{required:!0,message:"Input Description is required",trigger:"blur"},output_description:{required:!0,message:"Output Description is required",trigger:"blur"}},backPath:"",loadingCompile:!1,mode:"",contest:{},codeTemplate:{},pid:null,contestID:null,contestProblem:{displayId:null,displayTitle:null,cid:null,pid:null},problem:{id:null,title:"",problemId:"",description:"",input:"",output:"",timeLimit:1e3,memoryLimit:256,stackLimit:128,difficulty:1,auth:3,codeShare:!0,examples:[],spjLanguage:"",spjCode:"",spjCompileOk:!1,uploadTestcaseDir:"",testCaseScore:[],isRemote:!1,isRemoveEndBlank:!0,openCaseResult:!0,isUploadCase:!0,type:0,hint:"",source:"",cid:null,judgeMode:"default",judgeCaseMode:"default",userExtraFile:"",judgeExtraFile:""},problemTags:[],problemLanguages:[],problemSamples:[],problemCodeTemplate:[],reProblem:{},testCaseUploaded:!1,allLanguage:[],allSpjLanguage:[],allTags:[],allTagsTmp:[],inputVisible:!1,tagInput:"",title:"",spjMode:"",disableRuleType:!1,routeName:"",uploadTestcaseDir:"",uploadFileUrl:"",error:{tags:"",spj:"",languages:"",testCase:""},PROBLEM_LEVEL:{},JUDGE_CASE_MODE:{},spjRecord:{spjCode:"",spjLanguage:""},addUserExtraFile:!1,addJudgeExtraFile:!1,userExtraFile:null,judgeExtraFile:null}},mounted(){this.PROBLEM_LEVEL=Object.assign({},p["h"]),this.JUDGE_CASE_MODE=Object.assign({},p["e"]),this.routeName=this.$route.name;let e=this.$route.params.contestId;this.uploadFileUrl="/api/file/upload-testcase-zip","admin-edit-problem"===this.routeName||"admin-edit-contest-problem"===this.routeName?this.mode="edit":this.mode="add",o["a"].admin_getAllProblemTagList("ALL").then(e=>{this.allTags=e.data.data;for(let t of e.data.data)this.allTagsTmp.push({value:t.name,oj:t.oj})}).catch(()=>{}),o["a"].getLanguages(this.$route.params.problemId,!1).then(t=>{let l=t.data.data;this.allLanguage=l;for(let e=0;e<l.length;e++)1==l[e].isSpj&&this.allSpjLanguage.push(l[e]);this.problem=this.reProblem={id:null,problemId:"",title:"",description:"",input:"",output:"",timeLimit:1e3,memoryLimit:256,stackLimit:128,difficulty:1,auth:3,codeShare:!1,examples:[],spjLanguage:"",spjCode:"",spjCompileOk:!1,isRemoveEndBlank:!0,openCaseResult:!0,isUploadCase:!0,uploadTestcaseDir:"",testCaseScore:[],contestProblem:{},type:1,hint:"",source:"",cid:null,judgeMode:"default",judgeCaseMode:"default",userExtraFile:null,judgeExtraFile:null},this.contestID=e,e&&(this.problem.cid=this.reProblem.cid=e,this.problem.auth=this.reProblem.auth=3,this.disableRuleType=!0,o["a"].admin_getContest(e).then(e=>{this.problem.type=this.reProblem.type=e.data.data.type,this.contest=e.data.data})),this.problem.spjLanguage="C",this.init()})},watch:{$route(){this.routeName=this.$route.name,"admin-edit-problem"===this.routeName||"admin-edit-contest-problem"===this.routeName?this.mode="edit":this.mode="add",this.$refs.form.resetFields(),this.problem=this.reProblem,this.problemTags=[],this.problemLanguages=[],this.problemSamples=[],this.problemCodeTemplate=[],this.codeTemplate=[],this.init()},problemLanguages(e){let t={},l=JSON.parse(JSON.stringify(e)).sort();for(let s of l)if(void 0===this.codeTemplate[s]){let e,l=this.allLanguage.find(e=>e.name===s),a=this.problemCodeTemplate;a&&(e=a.find(e=>e.lid==l.id)),t[s]=void 0==e?{id:null,status:!1,code:l.codeTemplate,mode:l.contentType}:{id:e.id,status:!0,code:e.code,mode:l.contentType}}else t[s]=this.codeTemplate[s];this.codeTemplate=t},"problem.spjLanguage"(e){this.allSpjLanguage.length&&(this.spjMode=this.allSpjLanguage.find(e=>e.name==this.problem.spjLanguage&&1==e.isSpj)["contentType"])}},methods:{init(){if("edit"===this.mode){this.pid=this.$route.params.problemId,this.backPath=this.$route.query.back,this.title=this.$i18n.t("m.Edit_Problem");let e={"admin-edit-problem":"admin_getProblem","admin-edit-contest-problem":"admin_getContestProblem"}[this.routeName];o["a"][e](this.pid).then(e=>{let t=e.data.data;t.spjCompileOk=!1,t.uploadTestcaseDir="",t.testCaseScore=[],t.spjCode||(t.spjCode=""),t.spjLanguage=t.spjLanguage||"C",this.spjRecord.spjLanguage=t.spjLanguage,this.spjRecord.spjCode=t.spjCode,this.problem=t,this.problem["examples"]=i["a"].stringToExamples(t.examples),this.problem["examples"][0]["isOpen"]=!0,this.testCaseUploaded=!0,this.problem.userExtraFile&&(this.addUserExtraFile=!0,this.userExtraFile=JSON.parse(this.problem.userExtraFile)),this.problem.judgeExtraFile&&(this.addJudgeExtraFile=!0,this.judgeExtraFile=JSON.parse(this.problem.judgeExtraFile)),o["a"].admin_getProblemCases(this.pid,this.problem.isUploadCase).then(e=>{this.problem.isUploadCase?this.problem.testCaseScore=e.data.data:(this.problemSamples=e.data.data,this.problemSamples[0]["isOpen"]=!0)})}),"admin_getContestProblem"===e&&o["a"].admin_getContestProblemInfo(this.pid,this.contestID).then(e=>{this.contestProblem=e.data.data}),this.getProblemCodeTemplateAndLanguage(),o["a"].admin_getProblemTags(this.pid).then(e=>{this.problemTags=e.data.data})}else{this.addExample(),this.testCaseUploaded=!1,this.title=this.$i18n.t("m.Create_Problem");for(let e of this.allLanguage)this.problemLanguages.push(e.name)}},async getProblemCodeTemplateAndLanguage(){const e=this;await o["a"].getProblemCodeTemplate(e.pid).then(t=>{e.problemCodeTemplate=t.data.data}),o["a"].getProblemLanguages(e.pid).then(t=>{let l=t.data.data;for(let s=0;s<l.length;s++)e.problemLanguages.push(l[s].name)})},switchMode(e){let t="General_Judge",l="General_Judge_Mode_Tips";"spj"==e?(t="Special_Judge",l="Special_Judge_Mode_Tips"):"interactive"==e&&(t="Interactive_Judge",l="Interactive_Judge_Mode_Tips");const s=this.$createElement;this.$msgbox({title:this.$i18n.t("m."+t),message:s("div",null,[s("p",{style:"text-align: center;font-weight:bolder;color:red"},this.$i18n.t("m.Change_Judge_Mode")),s("br",null,null),s("p",{style:"font-weight:bolder"},this.$i18n.t("m."+l))])})},querySearch(e,t){var l="LOCAL";this.problem.isRemote&&(l=this.problem.problemId.split("-")[0]);var s=this.allTagsTmp.filter(e=>e.oj==l),a=e?s.filter(t=>0===t.value.toLowerCase().indexOf(e.toLowerCase())):s;t(a)},changeContent(e){this.announcement.content=e},getLevelName(e){return i["a"].getLevelName(e)},selectTag(e){for(var t=0;t<this.problemTags.length;t++)if(this.problemTags[t].name==e.value)return m["a"].warning(this.$i18n.t("m.Add_Tag_Error")),void(this.tagInput="");this.tagInput=e.value},addTag(e){let t={name:this.tagInput};if(this.tagInput){for(var l=0;l<this.problemTags.length;l++)if(this.problemTags[l].name==this.tagInput)return m["a"].warning(this.$i18n.t("m.Add_Tag_Error")),void(this.tagInput="");this.problemTags.push(t),this.inputVisible=!1,this.tagInput=""}},closeTag(e){this.problemTags.splice(this.problemTags.map(e=>e.name).indexOf(e),1)},deleteFile(e,t){"user"==e?this.$delete(this.userExtraFile,t):this.$delete(this.judgeExtraFile,t)},upsertFile(e,t,l,s){"user"==e?(l&&l!=t&&this.$delete(this.userExtraFile,l),this.userExtraFile||(this.userExtraFile={}),this.userExtraFile[t]=s):(l&&l!=t&&this.$delete(this.judgeExtraFile,t),this.judgeExtraFile||(this.judgeExtraFile={}),this.judgeExtraFile[t]=s)},problemTypeChange(e){if(1==e){let e=this.problemSamples.length,t=parseInt(100/e),l=100-t*e;for(let s=0;s<e;s++)this.problemSamples[s].score=s>=e-l?t+1:t}},addExample(){this.problem.examples.push({input:"",output:"",isOpen:!0})},changeExampleVisible(e,t){this.problem.examples[e]["isOpen"]=t},addSample(){this.mode,this.problemSamples.push({input:"",output:"",score:0==this.problem.type?null:0,pid:this.pid,isOpen:!0})},deleteExample(e){this.problem.examples.splice(e,1)},deleteSample(e){this.problemSamples.splice(e,1)},changeSampleVisible(e,t){this.problemSamples[e]["isOpen"]=t},uploadSucceeded(e){if(200!=e.status)return m["a"].error(e.msg),void(this.testCaseUploaded=!1);m["a"].success(this.$i18n.t("m.Upload_Testcase_Successfully"));let t=e.data.fileList,l=parseInt(100/t.length),s=100-l*t.length;for(let a=0;a<t.length;a++)l&&(a>=t.length-s?t[a].score=l+1:t[a].score=l),t[a].output||(t[a].output="-"),t[a].pid=this.problem.id;this.problem.testCaseScore=t,this.testCaseUploaded=!0,this.problem.uploadTestcaseDir=e.data.fileListDir},uploadFailed(){m["a"].error(this.$i18n.t("m.Upload_Testcase_Failed"))},compileSPJ(){let e={pid:this.problem.id,code:this.problem.spjCode,language:this.problem.spjLanguage,extraFiles:this.judgeExtraFile};this.loadingCompile=!0;let t="compileSPJ";"interactive"==this.problem.judgeMode&&(t="compileInteractive"),o["a"][t](e).then(e=>{this.loadingCompile=!1,this.problem.spjCompileOk=!0,this.error.spj="",m["a"].success(e.data.msg)},e=>{this.loadingCompile=!1,this.problem.spjCompileOk=!1;const t=this.$createElement;this.$msgbox({title:"Compile Error",type:"error",message:t("pre",e.data.msg),showCancelButton:!1,closeOnClickModal:!1,customClass:"dialog-compile-error"})})},submit(){if(!this.problem.problemId)return void m["a"].error(this.$i18n.t("m.Problem_Display_ID")+" "+this.$i18n.t("m.is_required"));if(this.contestID){if(!this.contestProblem.displayId)return void m["a"].error(this.$i18n.t("m.Contest_Display_ID")+" "+this.$i18n.t("m.is_required"));if(!this.contestProblem.displayTitle)return void m["a"].error(this.$i18n.t("m.Contest_Display_Title")+" "+this.$i18n.t("m.is_required"))}if(!this.problem.isRemote)if(this.problem.isUploadCase){if(!this.testCaseUploaded)return this.error.testCase=this.$i18n.t("m.Judge_Samples")+" "+this.$i18n.t("m.is_required"),void m["a"].error(this.error.testCase);if(1==this.problem.type)for(let e=0;e<this.problemSamples.length;e++){if(""==this.problemSamples[e].score)return void m["a"].error(this.$i18n.t("m.Problem_Sample")+(e+1)+" "+this.$i18n.t("m.Score_must_be_an_integer"));try{if(parseInt(this.problemSamples[e].score)<0)return void m["a"].error(this.$i18n.t("m.Problem_Sample")+(e+1)+" "+this.$i18n.t("m.Score_must_be_greater_than_or_equal_to_0"))}catch(p){return void m["a"].error(this.$i18n.t("m.Score_must_be_an_integer"))}}}else{if(!this.problemSamples.length)return void m["a"].error(this.$i18n.t("m.Judge_Samples")+" "+this.$i18n.t("m.is_required"));for(let e of this.problemSamples)if(!e.input&&!e.output)return void m["a"].error(this.$i18n.t("m.Sample_Input")+" or "+this.$i18n.t("m.Sample_Output")+" "+this.$i18n.t("m.is_required"));if(1==this.problem.type)for(let e=0;e<this.problemSamples.length;e++){if(""==this.problemSamples[e].score)return void m["a"].error(this.$i18n.t("m.Problem_Sample")+(e+1)+" "+this.$i18n.t("m.Score_must_be_an_integer"));try{if(parseInt(this.problemSamples[e].score)<0)return void m["a"].error(this.$i18n.t("m.Problem_Sample")+(e+1)+" "+this.$i18n.t("m.Score_must_be_greater_than_or_equal_to_0"))}catch(p){return void m["a"].error(this.$i18n.t("m.Score_must_be_an_integer"))}}}if(!this.problemTags.length)return this.error.tags=this.$i18n.t("m.Tags")+" "+this.$i18n.t("m.is_required"),void m["a"].error(this.error.tags);let e=this.spjRecord.spjLanguage!=this.problem.spjLanguage||this.spjRecord.spjCode!=this.problem.spjCode;if(!this.problem.isRemote&&"default"!=this.problem.judgeMode&&(this.problem.spjCode?!this.problem.spjCompileOk&&e&&(this.error.spj=this.$i18n.t("m.Spj_Or_Interactive_Code_not_Compile_Success")):(this.error.spj=this.$i18n.t("m.Spj_Or_Interactive_Code")+" "+this.$i18n.t("m.is_required"),m["a"].error(this.error.spj)),this.error.spj))return void m["a"].error(this.error.spj);if(!this.problemLanguages.length)return this.error.languages=this.$i18n.t("m.Language")+" "+this.$i18n.t("m.is_required"),void m["a"].error(this.error.languages);let t={"admin-create-problem":"admin_createProblem","admin-edit-problem":"admin_editProblem","admin-create-contest-problem":"admin_createContestProblem","admin-edit-contest-problem":"admin_editContestProblem"}[this.routeName];"editContestProblem"===t&&(this.problem.cid=this.contest.id),"admin_createProblem"!==t&&"admin_createContestProblem"!==t||(this.problem.author=this.userInfo.username);var l="LOCAL";this.problem.isRemote&&(l=this.problem.problemId.split("-")[0]);let s=Object.assign([],this.problemTags);for(let i=0;i<s.length;i++)for(let e of this.allTags)if(s[i].name==e.name&&e.oj==l){s[i]=e;break}this.problemCodeTemplate=[];let a=Object.assign([],this.problemLanguages);for(let i=0;i<a.length;i++){a[i]={name:a[i]};for(let e of this.allLanguage)if(a[i].name==e.name){a[i]=e,this.codeTemplate[e.name].status&&this.problemCodeTemplate.push({id:this.codeTemplate[e.name].id,pid:this.pid,code:this.codeTemplate[e.name].code,lid:e.id,status:this.codeTemplate[e.name].status});break}}let r={};this.problem.isRemote||("default"!=this.problem.judgeMode?e&&(r["changeModeCode"]=!0):this.spjRecord.spjCode||(r["changeModeCode"]=!0,this.problem.spjCode=null,this.problem.spjLanguage=null),this.userExtraFile&&0!=Object.keys(this.userExtraFile).length?this.problem.userExtraFile=JSON.stringify(this.userExtraFile):this.problem.userExtraFile=null,this.judgeExtraFile&&0!=Object.keys(this.judgeExtraFile).length?this.problem.judgeExtraFile=JSON.stringify(this.judgeExtraFile):this.problem.judgeExtraFile=null),r["problem"]=Object.assign({},this.problem),r.problem.examples=i["a"].examplesToString(this.problem.examples),r["codeTemplates"]=this.problemCodeTemplate,r["tags"]=s,r["languages"]=a,r["isUploadTestCase"]=this.problem.isUploadCase,r["uploadTestcaseDir"]=this.problem.uploadTestcaseDir,r["judgeMode"]=this.problem.judgeMode,this.problem.isUploadCase?r["samples"]=this.problem.testCaseScore:r["samples"]=this.problemSamples,o["a"][t](r).then(e=>{"admin-create-contest-problem"===this.routeName||"admin-edit-contest-problem"===this.routeName?(e.data.data&&(this.contestProblem["pid"]=e.data.data.pid,this.contestProblem["cid"]=this.$route.params.contestId),o["a"].admin_setContestProblemInfo(this.contestProblem).then(e=>{m["a"].success("success"),this.$router.push({name:"admin-contest-problem-list",params:{contestId:this.$route.params.contestId}})})):(m["a"].success("success"),this.backPath?this.$router.push({path:this.backPath}):this.$router.push({name:"admin-problem-list"}))}).catch(()=>{})}},computed:{...Object(r["c"])(["userInfo"])}},b=h,g=(l("b502"),l("0b56")),_=Object(g["a"])(b,s,a,!1,null,"8512528a",null);t["default"]=_.exports}}]);