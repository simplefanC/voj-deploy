(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d5f7150"],{"3c60":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"section-title"},[t._v(t._s(t.$t("m.Avatar_Setting")))]),e("div",{staticClass:"section-main"},[e("avatar",{staticStyle:{"margin-bottom":"15px"},attrs:{inline:!0,size:130,src:t.avatar,username:t.formProfile.username,color:"#FFF"}}),t.avatarOption.imgSrc?[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{md:12,xs:24}},[e("div",{staticClass:"cropper-main inline"},[e("vueCropper",{ref:"cropper",attrs:{autoCropHeight:200,autoCropWidth:200,img:t.avatarOption.imgSrc,info:!0,outputSize:t.avatarOption.size,outputType:t.avatarOption.outputType,autoCrop:"",fixed:""},on:{realTime:t.realTime}})],1),e("div",{staticClass:"cropper-btn"},[e("el-tooltip",{staticClass:"item",attrs:{content:"向左旋转90°",effect:"dark",placement:"bottom",trigger:"hover"}},[e("el-button",{attrs:{icon:"el-icon-refresh-left",size:"mini"},on:{click:function(e){return t.rotate("left")}}})],1),e("el-tooltip",{staticClass:"item",attrs:{content:"向右旋转90°",effect:"dark",placement:"bottom",trigger:"hover"}},[e("el-button",{attrs:{icon:"el-icon-refresh-right",size:"mini"},on:{click:function(e){return t.rotate("right")}}})],1),e("el-tooltip",{staticClass:"item",attrs:{content:"关闭图像截取",effect:"dark",placement:"bottom",trigger:"hover"}},[e("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:t.reselect}})],1),e("el-tooltip",{staticClass:"item",attrs:{content:"确定图像截取",effect:"dark",placement:"bottom",trigger:"hover"}},[e("el-button",{attrs:{icon:"el-icon-check",size:"mini"},on:{click:t.finishCrop}})],1)],1)]),e("el-col",{attrs:{md:12,xs:24}},[e("div",{staticClass:"cropper-preview",style:t.previewStyle},[e("div",{style:t.preview.div},[e("img",{style:t.preview.img,attrs:{src:t.avatarOption.imgSrc}})])])])],1)]:[e("el-upload",{staticClass:"upload-container",attrs:{"before-upload":t.handleSelectFile,action:"",drag:""}},[e("div",{staticStyle:{padding:"20px 0"}},[e("i",{staticClass:"el-icon-upload",staticStyle:{color:"#3399ff","font-size":"52px"}}),e("p",[t._v(t._s(t.$t("m.Upload_avatar_hint")))])])])],e("el-dialog",{attrs:{title:t.$t("m.Upload"),visible:t.uploadModalVisible,width:"350px"},on:{"update:visible":function(e){t.uploadModalVisible=e}}},[e("div",{staticClass:"upload-modal"},[e("p",{staticClass:"notice"},[t._v(t._s(t.$t("m.Your_new_avatar")+":"))]),e("img",{attrs:{src:t.uploadImgSrc}})]),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{loading:t.loadingUploadBtn,type:"primary"},on:{click:t.uploadAvatar}},[t._v(t._s(t.$t("m.Upload"))+" ")])],1)])],2),e("div",{staticClass:"section-title"},[t._v(t._s(t.$t("m.UserInfo_Setting")))]),e("el-form",{ref:"formProfile",attrs:{model:t.formProfile}},[e("el-row",{attrs:{gutter:30,justify:"space-around"}},[e("el-col",{attrs:{md:10,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.RealName")}},[e("el-input",{attrs:{maxlength:50},model:{value:t.formProfile.realname,callback:function(e){t.$set(t.formProfile,"realname",e)},expression:"formProfile.realname"}})],1),e("el-form-item",{attrs:{label:t.$t("m.Nickname")}},[e("el-input",{attrs:{maxlength:20},model:{value:t.formProfile.nickname,callback:function(e){t.$set(t.formProfile,"nickname",e)},expression:"formProfile.nickname"}})],1),e("el-form-item",{attrs:{label:t.$t("m.School")}},[e("el-input",{attrs:{maxlength:50},model:{value:t.formProfile.school,callback:function(e){t.$set(t.formProfile,"school",e)},expression:"formProfile.school"}})],1),e("el-form-item",{attrs:{label:t.$t("m.Student_Number")}},[e("el-input",{attrs:{maxlength:20},model:{value:t.formProfile.number,callback:function(e){t.$set(t.formProfile,"number",e)},expression:"formProfile.number"}})],1)],1),e("el-col",{attrs:{lg:4,md:4}},[e("div",{staticClass:"separator hidden-md-and-down"}),e("p")]),e("el-col",{attrs:{md:10,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.CF_Username")}},[e("el-input",{attrs:{maxlength:50},model:{value:t.formProfile.cfUsername,callback:function(e){t.$set(t.formProfile,"cfUsername",e)},expression:"formProfile.cfUsername"}})],1),e("el-form-item",{attrs:{label:t.$t("m.Blog")}},[e("el-input",{attrs:{maxlength:255},model:{value:t.formProfile.blog,callback:function(e){t.$set(t.formProfile,"blog",e)},expression:"formProfile.blog"}})],1),e("el-form-item",{attrs:{label:t.$t("m.Github")}},[e("el-input",{attrs:{maxlength:255},model:{value:t.formProfile.github,callback:function(e){t.$set(t.formProfile,"github",e)},expression:"formProfile.github"}})],1),e("el-form-item",{attrs:{label:t.$t("m.Gender")}},[e("el-radio-group",{model:{value:t.formProfile.gender,callback:function(e){t.$set(t.formProfile,"gender",e)},expression:"formProfile.gender"}},[e("el-radio",{attrs:{border:"",label:"male",size:"small"}},[t._v(t._s(t.$t("m.Male"))+" ")]),e("el-radio",{attrs:{border:"",label:"female",size:"small"}},[t._v(t._s(t.$t("m.Female"))+" ")]),e("el-radio",{attrs:{border:"",label:"secrecy",size:"small"}},[t._v(t._s(t.$t("m.Secrecy"))+" ")])],1)],1)],1)],1),e("el-row",[e("el-col",{attrs:{span:24}},[e("label",{staticClass:"el-form-item__label",staticStyle:{float:"none"}},[t._v(t._s(t.$t("m.Signature")))]),e("Editor",{staticStyle:{padding:"5px"},attrs:{value:t.formProfile.signature},on:{"update:value":function(e){return t.$set(t.formProfile,"signature",e)}}})],1)],1)],1),e("div",{staticStyle:{"text-align":"center","margin-top":"10px"}},[e("el-button",{attrs:{loading:t.loadingSaveBtn,type:"primary"},on:{click:t.updateUserInfo}},[t._v(t._s(t.$t("m.Save"))+" ")])],1)],1)},r=[],o=a("3228"),l=a("90b9"),s=a("7aa9"),n=a("965d"),c=a("3ea1"),m=a.n(c);a("5cbd");const p=()=>a.e("chunk-1b666b40").then(a.bind(null,"a956"));var f={components:{Avatar:m.a,VueCropper:n["VueCropper"],Editor:p},data(){return{loadingSaveBtn:!1,loadingUploadBtn:!1,uploadModalVisible:!1,preview:{},uploadImgSrc:"",avatarOption:{imgSrc:"",size:.8,outputType:"png"},formProfile:{realname:"",username:"",cfUsername:"",gender:"",nickname:"",signature:"",number:"",blog:"",school:"",github:""}}},mounted(){let t=this.$store.getters.userInfo;Object.keys(this.formProfile).forEach(e=>{void 0!==t[e]&&(this.formProfile[e]=t[e])})},methods:{checkFileType(t){return!!/\.(gif|jpg|jpeg|png|bmp|webp|GIF|JPG|PNG|WEBP)$/.test(t.name)||(this.$notify.warning({title:this.$i18n.t("m.File_type_not_support"),message:t.name+this.$i18n.t("m.is_incorrect_format_file")}),!1)},checkFileSize(t){return!(t.size>2097152)||(this.$notify.warning({title:this.$i18n.t("m.Exceed_max_size_limit"),message:t.name+this.$i18n.t("m.File_Exceed_Tips")}),!1)},handleSelectFile(t){let e=this.checkFileType(t)&&this.checkFileSize(t);if(!e)return!1;let a=new window.FileReader;return a.onload=t=>{this.avatarOption.imgSrc=t.target.result},a.readAsDataURL(t),!1},realTime(t){this.preview=t},rotate(t){"left"===t?this.$refs.cropper.rotateLeft():this.$refs.cropper.rotateRight()},reselect(){this.$confirm(this.$i18n.t("m.Cancel_Avatar_Tips"),"Tips",{confirmButtonText:this.$i18n.t("m.OK"),cancelButtonText:this.$i18n.t("m.Cancel"),type:"warning"}).then(()=>{this.avatarOption.imgSrc=""})},finishCrop(){this.$refs.cropper.getCropData(t=>{this.uploadImgSrc=t,this.uploadModalVisible=!0})},uploadAvatar(){this.$refs.cropper.getCropBlob(t=>{let e=new window.FormData,a=new window.File([t],"avatar."+this.avatarOption.outputType);e.append("image",a),this.loadingUploadBtn=!0,this.$http({method:"post",url:"/api/file/upload-avatar",data:e,headers:{"content-type":"multipart/form-data"}}).then(t=>{this.loadingUploadBtn=!1,s["a"].success(t.data.msg),this.uploadModalVisible=!1,this.avatarOption.imgSrc="",this.$store.dispatch("setUserInfo",t.data.data)},()=>{this.loadingUploadBtn=!1})})},updateUserInfo(){this.loadingSaveBtn=!0;let t=l["a"].filterEmptyValue(Object.assign({},this.formProfile));o["a"].changeUserInfo(t).then(t=>{s["a"].success(this.$i18n.t("m.Update_Successfully")),this.$store.dispatch("setUserInfo",t.data.data),this.loadingSaveBtn=!1},t=>{this.loadingSaveBtn=!1})}},computed:{avatar(){return this.$store.getters.userInfo.avatar},previewStyle(){return{width:this.preview.w+"px",height:this.preview.h+"px",overflow:"hidden"}}}},d=f,u=(a("bb7f"),a("0b56")),h=Object(u["a"])(d,i,r,!1,null,"0c617d8e",null);e["default"]=h.exports},"7dc6":function(t,e,a){},bb7f:function(t,e,a){"use strict";a("7dc6")}}]);