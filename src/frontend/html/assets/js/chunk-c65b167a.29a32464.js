(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c65b167a"],{2777:function(t,e,s){},4675:function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"view"},[e("el-card",[e("div",{attrs:{slot:"header"},slot:"header"},[e("span",{staticClass:"panel-title home-title"},[t._v(" "+t._s(t.title)+" ")])]),e("el-form",{attrs:{"label-position":"top"}},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:24}},[e("el-form-item",{attrs:{label:t.$t("m.Contest_Title"),required:""}},[e("el-input",{attrs:{placeholder:t.$t("m.Contest_Title")},model:{value:t.contest.title,callback:function(e){t.$set(t.contest,"title",e)},expression:"contest.title"}})],1)],1),e("el-col",{attrs:{span:24}},[e("el-form-item",{attrs:{label:t.$t("m.Contest_Description"),required:""}},[e("Editor",{attrs:{value:t.contest.description},on:{"update:value":function(e){return t.$set(t.contest,"description",e)}}})],1)],1),e("el-col",{attrs:{md:8,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.Start_Time"),required:""}},[e("el-date-picker",{attrs:{placeholder:t.$t("m.Start_Time"),type:"datetime"},on:{change:t.changeDuration},model:{value:t.contest.startTime,callback:function(e){t.$set(t.contest,"startTime",e)},expression:"contest.startTime"}})],1)],1),e("el-col",{attrs:{md:8,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.Contest_End_Time"),required:""}},[e("el-date-picker",{attrs:{placeholder:t.$t("m.Contest_End_Time"),type:"datetime"},on:{change:t.changeDuration},model:{value:t.contest.endTime,callback:function(e){t.$set(t.contest,"endTime",e)},expression:"contest.endTime"}})],1)],1),e("el-col",{attrs:{md:8,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.Contest_Duration"),required:""}},[e("el-input",{attrs:{disabled:""},model:{value:t.durationText,callback:function(e){t.durationText=e},expression:"durationText"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{md:8,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.Contest_Rule_Type"),required:""}},[e("el-radio",{staticClass:"radio",attrs:{label:0},on:{change:t.setSealRankTimeDefaultValue},model:{value:t.contest.type,callback:function(e){t.$set(t.contest,"type",e)},expression:"contest.type"}},[t._v("ACM ")]),e("el-radio",{staticClass:"radio",attrs:{label:1},on:{change:t.setSealRankTimeDefaultValue},model:{value:t.contest.type,callback:function(e){t.$set(t.contest,"type",e)},expression:"contest.type"}},[t._v("OI ")])],1)],1),e("el-col",{attrs:{md:8,xs:24}},[e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==t.contest.type,expression:"contest.type == 1"}],attrs:{label:t.$t("m.OI_Rank_Score_Type")}},[e("el-radio",{staticClass:"radio",attrs:{label:"Recent"},model:{value:t.contest.oiRankScoreType,callback:function(e){t.$set(t.contest,"oiRankScoreType",e)},expression:"contest.oiRankScoreType"}},[t._v(t._s(t.$t("m.OI_Rank_Score_Type_Recent"))+" ")]),e("el-radio",{staticClass:"radio",attrs:{label:"Highest"},model:{value:t.contest.oiRankScoreType,callback:function(e){t.$set(t.contest,"oiRankScoreType",e)},expression:"contest.oiRankScoreType"}},[t._v(t._s(t.$t("m.OI_Rank_Score_Type_Highest"))+" ")])],1)],1)],1),e("el-row",{attrs:{gutter:20}},[t.contest.sealRank?e("el-col",{attrs:{md:8,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.Contest_Seal_Rank"),required:""}},[e("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.contest.sealRank,callback:function(e){t.$set(t.contest,"sealRank",e)},expression:"contest.sealRank"}})],1)],1):e("el-col",{attrs:{md:24,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.Contest_Seal_Rank"),required:""}},[e("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":""},on:{change:t.setSealRankTimeDefaultValue},model:{value:t.contest.sealRank,callback:function(e){t.$set(t.contest,"sealRank",e)},expression:"contest.sealRank"}})],1)],1),e("el-col",{attrs:{md:8,xs:24}},[e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.contest.sealRank,expression:"contest.sealRank"}],attrs:{label:t.$t("m.Seal_Rank_Time"),required:t.contest.sealRank}},[e("el-select",{model:{value:t.seal_rank_time,callback:function(e){t.seal_rank_time=e},expression:"seal_rank_time"}},[e("el-option",{attrs:{disabled:t.contest.duration<1800,label:t.$t("m.Contest_Seal_Half_Hour"),value:0}}),e("el-option",{attrs:{disabled:t.contest.duration<3600,label:t.$t("m.Contest_Seal_An_Hour"),value:1}}),e("el-option",{attrs:{label:t.$t("m.Contest_Seal_All_Hour"),value:2}})],1)],1)],1),e("el-col",{attrs:{md:8,xs:24}},[e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.contest.sealRank,expression:"contest.sealRank"}],attrs:{label:t.$t("m.Real_Rank_After_Contest"),required:""}},[e("el-switch",{model:{value:t.contest.autoRealRank,callback:function(e){t.$set(t.contest,"autoRealRank",e)},expression:"contest.autoRealRank"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{md:8,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.Contest_Outside_ScoreBoard"),required:""}},[e("el-switch",{model:{value:t.contest.openRank,callback:function(e){t.$set(t.contest,"openRank",e)},expression:"contest.openRank"}})],1)],1),e("el-col",{attrs:{md:8,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.Rank_Show_Name"),required:""}},[e("el-radio-group",{model:{value:t.contest.rankShowName,callback:function(e){t.$set(t.contest,"rankShowName",e)},expression:"contest.rankShowName"}},[e("el-radio",{attrs:{label:"username"}},[t._v(t._s(t.$t("m.Show_Username"))+" ")]),e("el-radio",{attrs:{label:"nickname"}},[t._v(t._s(t.$t("m.Show_Nickname"))+" ")]),e("el-radio",{attrs:{label:"realname"}},[t._v(t._s(t.$t("m.Show_Realname"))+" ")])],1)],1)],1),e("el-col",{attrs:{md:8,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.Print_Func"),required:""}},[e("el-switch",{model:{value:t.contest.openPrint,callback:function(e){t.$set(t.contest,"openPrint",e)},expression:"contest.openPrint"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{md:8,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.Contest_Admin_Rank"),required:""}},[e("el-switch",{model:{value:t.contest.contestAdminRank,callback:function(e){t.$set(t.contest,"contestAdminRank",e)},expression:"contest.contestAdminRank"}})],1)],1),e("el-col",{attrs:{md:8,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.Contest_Admin_Visible"),required:""}},[e("el-switch",{model:{value:t.contest.contestAdminVisible,callback:function(e){t.$set(t.contest,"contestAdminVisible",e)},expression:"contest.contestAdminVisible"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",[e("el-form-item",{attrs:{label:t.$t("m.Star_User_UserName"),required:""}},[t._l(t.contest.starAccount,(function(s){return e("el-tag",{key:s,staticStyle:{"margin-right":"7px","margin-top":"4px"},attrs:{"close-transition":!1,closable:"",size:"medium",type:"warning"},on:{close:function(e){return t.removeStarUser(s)}}},[t._v(t._s(s)+" ")])})),t.inputVisible?e("el-input",{staticClass:"input-new-star-user",attrs:{"trigger-on-focus":!0,size:"medium"},on:{blur:t.addStarUser},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addStarUser.apply(null,arguments)}},model:{value:t.starUserInput,callback:function(e){t.starUserInput=e},expression:"starUserInput"}}):e("el-tooltip",{attrs:{content:t.$t("m.Add"),effect:"dark",placement:"top"}},[e("el-button",{staticClass:"button-new-tag",attrs:{icon:"el-icon-plus",size:"small"},on:{click:function(e){t.inputVisible=!0}}})],1)],2)],1)],1),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{md:6,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.Contest_Auth"),required:""}},[e("el-select",{model:{value:t.contest.auth,callback:function(e){t.$set(t.contest,"auth",e)},expression:"contest.auth"}},[e("el-option",{attrs:{label:t.$t("m.Public"),value:0}}),e("el-option",{attrs:{label:t.$t("m.Private"),value:1}}),e("el-option",{attrs:{label:t.$t("m.Protected"),value:2}})],1)],1)],1),e("el-col",{attrs:{md:4,xs:24}},[e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0!=t.contest.auth,expression:"contest.auth != 0"}],attrs:{label:t.$t("m.Password_Limit"),required:0!=t.contest.auth}},[e("el-switch",{model:{value:t.contest.openPwdLimit,callback:function(e){t.$set(t.contest,"openPwdLimit",e)},expression:"contest.openPwdLimit"}})],1)],1),e("el-col",{attrs:{md:6,xs:24}},[e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.contest.openPwdLimit,expression:"contest.openPwdLimit"}],attrs:{label:t.$t("m.Contest_Password"),required:t.contest.openPwdLimit}},[e("el-input",{staticStyle:{width:"80%"},attrs:{placeholder:t.$t("m.Contest_Password")},model:{value:t.contest.pwd,callback:function(e){t.$set(t.contest,"pwd",e)},expression:"contest.pwd"}})],1)],1),e("el-col",{attrs:{md:8,xs:24}},[e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0!=t.contest.auth,expression:"contest.auth != 0"}],attrs:{label:t.$t("m.Account_Limit"),required:0!=t.contest.auth}},[e("el-switch",{model:{value:t.contest.openAccountLimit,callback:function(e){t.$set(t.contest,"openAccountLimit",e)},expression:"contest.openAccountLimit"}})],1)],1)],1),e("el-row",{attrs:{gutter:20}},[t.contest.openAccountLimit?[e("el-form",{attrs:{model:t.formRule}},[e("el-col",{attrs:{md:6,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.Prefix"),prop:"prefix"}},[e("el-input",{attrs:{placeholder:"Prefix"},model:{value:t.formRule.prefix,callback:function(e){t.$set(t.formRule,"prefix",e)},expression:"formRule.prefix"}})],1)],1),e("el-col",{attrs:{md:6,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.Suffix"),prop:"suffix"}},[e("el-input",{attrs:{placeholder:"Suffix"},model:{value:t.formRule.suffix,callback:function(e){t.$set(t.formRule,"suffix",e)},expression:"formRule.suffix"}})],1)],1),e("el-col",{attrs:{md:6,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.Start_Number"),prop:"number_from"}},[e("el-input-number",{staticStyle:{width:"100%"},model:{value:t.formRule.number_from,callback:function(e){t.$set(t.formRule,"number_from",e)},expression:"formRule.number_from"}})],1)],1),e("el-col",{attrs:{md:6,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.End_Number"),prop:"number_to"}},[e("el-input-number",{staticStyle:{width:"100%"},model:{value:t.formRule.number_to,callback:function(e){t.$set(t.formRule,"number_to",e)},expression:"formRule.number_to"}})],1)],1),t.formRule.number_from<=t.formRule.number_to?e("div",{staticClass:"userPreview"},[t._v(" "+t._s(t.$t("m.The_allowed_account_will_be"))+" "+t._s(t.formRule.prefix+(""+t.formRule.number_from).padStart(t.formRule.number_to.toString().length,"0")+t.formRule.suffix)+", "),t.formRule.number_from+1<t.formRule.number_to?e("span",[t._v(" "+t._s(t.formRule.prefix+(""+t.formRule.number_from+1).padStart(t.formRule.number_to.toString().length,"0")+t.formRule.suffix+"...")+" ")]):t._e(),t.formRule.number_from+1<=t.formRule.number_to?e("span",[t._v(" "+t._s(t.formRule.prefix+t.formRule.number_to+t.formRule.suffix)+" ")]):t._e()]):t._e(),e("el-col",{attrs:{md:24,xs:24}},[e("el-form-item",{attrs:{label:t.$t("m.Extra_Account"),prop:"prefix"}},[e("el-input",{attrs:{placeholder:t.$t("m.Extra_Account_Tips"),rows:8,type:"textarea"},model:{value:t.formRule.extra_account,callback:function(e){t.$set(t.formRule,"extra_account",e)},expression:"formRule.extra_account"}})],1)],1)],1)]:t._e()],2)],1),e("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.saveContest.apply(null,arguments)}}},[t._v(t._s(t.$t("m.Save"))+" ")])],1)],1)},a=[],o=(s("24b8"),s("3228")),i=s("ffb0"),r=s("2f42"),l=s.n(r),c=s("7736"),u=s("7aa9");const m=()=>s.e("chunk-1b666b40").then(s.bind(null,"a956"));var d={name:"Contest",components:{Editor:m},data(){return{title:"Create Contest",disableRuleType:!1,durationText:"",seal_rank_time:2,contest:{title:"",description:"",startTime:"",endTime:"",duration:0,type:0,pwd:"",sealRank:!1,sealRankTime:"",autoRealRank:!1,auth:0,contestAdminRank:!1,contestAdminVisible:!1,openPrint:!1,rankShowName:"username",openPwdLimit:!1,openAccountLimit:!1,accountLimitRule:"",starAccount:[],oiRankScoreType:"Highest"},formRule:{prefix:"",suffix:"",number_from:0,number_to:10,extra_account:""},starUserInput:"",inputVisible:!1}},mounted(){"admin-edit-contest"===this.$route.name?(this.title=this.$i18n.t("m.Edit_Contest"),this.disableRuleType=!0,this.getContestByCid()):(this.title=this.$i18n.t("m.Create_Contest"),this.disableRuleType=!1)},watch:{$route(){"admin-edit-contest"===this.$route.name?(this.title=this.$i18n.t("m.Edit_Contest"),this.disableRuleType=!0,this.getContestByCid()):(this.title=this.$i18n.t("m.Create_Contest"),this.disableRuleType=!1,this.contest={})}},computed:{...Object(c["c"])(["userInfo"])},methods:{getContestByCid(){o["a"].admin_getContest(this.$route.params.contestId).then(t=>{let e=t.data.data;this.contest=e,this.changeDuration();let s=l()(this.contest.endTime).subtract(1800,"seconds").toString(),n=l()(this.contest.endTime).subtract(3600,"seconds").toString(),a=l()(this.contest.startTime).toString(),o=l()(this.contest.sealRankTime).toString();switch(o){case s:this.seal_rank_time=0;break;case n:this.seal_rank_time=1;break;case a:this.seal_rank_time=2;break}this.contest.accountLimitRule&&(this.formRule=this.changeStrToAccountRule(this.contest.accountLimitRule))}).catch(()=>{})},saveContest(){if(!this.contest.title)return void u["a"].error(this.$i18n.t("m.Contest_Title")+" "+this.$i18n.t("m.is_required"));if(!this.contest.description)return void u["a"].error(this.$i18n.t("m.Contest_Description")+" "+this.$i18n.t("m.is_required"));if(!this.contest.startTime)return void u["a"].error(this.$i18n.t("m.Start_Time")+" "+this.$i18n.t("m.is_required"));if(!this.contest.endTime)return void u["a"].error(this.$i18n.t("m.Contest_End_Time")+" "+this.$i18n.t("m.is_required"));if(!this.contest.duration||this.contest.duration<=0)return void u["a"].error(this.$i18n.t("m.Contest_Duration_Check"));if(0!=this.contest.auth){if(!this.contest.openPwdLimit&&!this.contest.openAccountLimit)return void u["a"].error(this.$i18n.t("m.Contest_Auth_Check_Tip"));if(this.contest.openPwdLimit&&!this.contest.pwd)return void u["a"].error(this.$i18n.t("m.Contest_Password")+" "+this.$i18n.t("m.is_required"));this.contest.openAccountLimit&&(this.contest.accountLimitRule=this.changeAccountRuleToStr(this.formRule))}let t="admin-edit-contest"===this.$route.name?"admin_editContest":"admin_createContest";switch(this.seal_rank_time){case 0:this.contest.sealRankTime=l()(this.contest.endTime).subtract(1800,"seconds");break;case 1:this.contest.sealRankTime=l()(this.contest.endTime).subtract(3600,"seconds");break;case 2:this.contest.sealRankTime=l()(this.contest.startTime)}let e=Object.assign({},this.contest);"admin_createContest"===t&&(e["uid"]=this.userInfo.uid,e["author"]=this.userInfo.username),o["a"][t](e).then(t=>{u["a"].success("success"),this.$router.push({name:"admin-contest-list",query:{refresh:"true"}})}).catch(()=>{})},changeDuration(){let t=this.contest.startTime,e=this.contest.endTime,s=i["a"].durationMs(t,e);if(s<0)return this.durationText=this.$i18n.t("m.Contest_Time_Check"),void(this.contest.duration=0);""!=t&&""!=e&&(this.durationText=i["a"].formatSpecificDuration(t,e),this.contest.duration=s)},changeAccountRuleToStr(t){let e="<prefix>"+t.prefix+"</prefix><suffix>"+t.suffix+"</suffix><start>"+t.number_from+"</start><end>"+t.number_to+"</end><extra>"+t.extra_account+"</extra>";return e},changeStrToAccountRule(t){let e="<prefix>([\\s\\S]*?)</prefix><suffix>([\\s\\S]*?)</suffix><start>([\\s\\S]*?)</start><end>([\\s\\S]*?)</end><extra>([\\s\\S]*?)</extra>",s=RegExp(e,"g"),n=s.exec(t);return{prefix:n[1],suffix:n[2],number_from:n[3],number_to:n[4],extra_account:n[5]}},addStarUser(){if(this.starUserInput=this.starUserInput.replace(/(^\s*)|(\s*$)/g,""),this.starUserInput){for(var t=0;t<this.contest.starAccount.length;t++)if(this.contest.starAccount[t]==this.starUserInput)return u["a"].warning(this.$i18n.t("m.Add_Star_User_Error")),void(this.starUserInput="");this.contest.starAccount.push(this.starUserInput),this.inputVisible=!1,this.starUserInput=""}},removeStarUser(t){this.contest.starAccount.splice(this.contest.starAccount.map(t=>t.name).indexOf(t),1)},setSealRankTimeDefaultValue(){1==this.contest.sealRank&&(0==this.contest.type?this.contest.duration<3600?this.seal_rank_time=2:this.seal_rank_time=1:this.seal_rank_time=2)}}},p=d,f=(s("a480"),s("0b56")),h=Object(f["a"])(p,n,a,!1,null,"5787c581",null);e["default"]=h.exports},a480:function(t,e,s){"use strict";s("2777")}}]);